<%= render "link", todo: @todo %>

<p style="color: green"><%= notice %></p>
<h1 class="visually-hidden">Todo</h1>

<div class="card-darker" id="<%= dom_id @todo %>">
  <div class="d-flex align-items-center">
    <%= form_with model: @todo, url: done_todo_path(@todo.task.project, @todo.task, @todo) do |form| %>
      <%= form.check_box :done, class: "form-check-input form-check-todo me-2", onchange: "this.form.submit()" %>
    <% end %>
    <h2 class="d-inline-block mb-0">
      <%= link_to @todo.name, [@todo.task.project, @todo.task, @todo] %>
    </h2>
    <div class="ms-auto dropdown text-white ms-3">
      <a class="py-1 nav-link" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
        <div class="three-dots"><i class="bi bi-three-dots fs-5"></i></div>
      </a>
      <ul class="dropdown-menu" data-bs-theme="dark">
        <li>
          <%= link_to edit_project_task_todo_path(@todo.task.project, @todo.task, @todo), class: "dropdown-item" do %>
            <i class="bi bi-pencil-square me-2"></i>Edit
          <% end %>
        </li>
        <li>
          <%= button_to [@todo.task.project, @todo.task, @todo], class: "dropdown-item", method: :delete do %>
            <i class="bi bi-trash me-2"></i>Delete
          <% end %>
        </li>
      </ul>
    </div>
  </div>

  <p>
    <strong>Description:</strong>
    <% if @todo.description.empty? %>
      <%= link_to "Add description", edit_project_task_todo_path(@todo.task.project, @todo.task, @todo) %>
    <% else %>
      <%= @todo.description %>
    <% end %>
  </p>

  <p>
    <div>
      <strong>Assigned to:</strong>
      <% if @todo.collaborators.empty? %>
        <%= link_to "Add collaborator", edit_project_task_todo_path(@todo.task.project, @todo.task, @todo) %>
      <% else %>
        <% @todo.collaborators.each do |collaborator| %>
          <%= profile_picture_small collaborator %>
          <%= collaborator.name %>
        <% end %>
      <% end %>
    </div>
  </p>

  <p>
    <strong>Due on:</strong>
    <% if @todo.due_on.nil? %>
      <%= link_to "Select a date", edit_project_task_todo_path(@todo.task.project, @todo.task, @todo) %>
    <% else %>
      <%= @todo.due_on %>
    <% end %>
  </p>

  <p>
    <strong>Done:</strong>
    <%= @todo.done %>
  </p>

  <p>
    <strong>Task:</strong>
    <%= @todo.task_id %>
  </p>
</div>
